package cmd

import (
	"backend/inernal/sui"
	"backend/internal/config"
	"fmt"

	"github.com/gin-gonic/gin"
)

func main() {
	logo := `
          _____                    _____            _____                    _____                            _____            _____                    _____                    _____          
         /\    \                  /\    \          /\    \                  /\    \                          /\    \          /\    \                  /\    \                  /\    \         
        /::\    \                /::\____\        /::\____\                /::\    \                        /::\____\        /::\    \                /::\____\                /::\____\        
       /::::\    \              /:::/    /       /:::/    /               /::::\    \                      /:::/    /        \:::\    \              /::::|   |               /:::/    /        
      /::::::\    \            /:::/    /       /:::/    /               /::::::\    \                    /:::/    /          \:::\    \            /:::::|   |              /:::/    /         
     /:::/\:::\    \          /:::/    /       /:::/    /               /:::/\:::\    \                  /:::/    /            \:::\    \          /::::::|   |             /:::/    /          
    /:::/__\:::\    \        /:::/    /       /:::/    /               /:::/__\:::\    \                /:::/    /              \:::\    \        /:::/|::|   |            /:::/____/           
   /::::\   \:::\    \      /:::/    /       /:::/    /               /::::\   \:::\    \              /:::/    /               /::::\    \      /:::/ |::|   |           /::::\    \           
  /::::::\   \:::\    \    /:::/    /       /:::/    /      _____    /::::::\   \:::\    \            /:::/    /       ____    /::::::\    \    /:::/  |::|   | _____    /::::::\____\________  
 /:::/\:::\   \:::\ ___\  /:::/    /       /:::/____/      /\    \  /:::/\:::\   \:::\    \          /:::/    /       /\   \  /:::/\:::\    \  /:::/   |::|   |/\    \  /:::/\:::::::::::\    \ 
/:::/__\:::\   \:::|    |/:::/____/       |:::|    /      /::\____\/:::/__\:::\   \:::\____\        /:::/____/       /::\   \/:::/  \:::\____\/:: /    |::|   /::\____\/:::/  |:::::::::::\____\
\:::\   \:::\  /:::|____|\:::\    \       |:::|____\     /:::/    /\:::\   \:::\   \::/    /        \:::\    \       \:::\  /:::/    \::/    /\::/    /|::|  /:::/    /\::/   |::|~~~|~~~~~     
 \:::\   \:::\/:::/    /  \:::\    \       \:::\    \   /:::/    /  \:::\   \:::\   \/____/          \:::\    \       \:::\/:::/    / \/____/  \/____/ |::| /:::/    /  \/____|::|   |          
  \:::\   \::::::/    /    \:::\    \       \:::\    \ /:::/    /    \:::\   \:::\    \               \:::\    \       \::::::/    /                   |::|/:::/    /         |::|   |          
   \:::\   \::::/    /      \:::\    \       \:::\    /:::/    /      \:::\   \:::\____\               \:::\    \       \::::/____/                    |::::::/    /          |::|   |          
    \:::\  /:::/    /        \:::\    \       \:::\__/:::/    /        \:::\   \::/    /                \:::\    \       \:::\    \                    |:::::/    /           |::|   |          
     \:::\/:::/    /          \:::\    \       \::::::::/    /          \:::\   \/____/                  \:::\    \       \:::\    \                   |::::/    /            |::|   |          
      \::::::/    /            \:::\    \       \::::::/    /            \:::\    \                       \:::\    \       \:::\    \                  /:::/    /             |::|   |          
       \::::/    /              \:::\____\       \::::/    /              \:::\____\                       \:::\____\       \:::\____\                /:::/    /              \::|   |          
        \::/____/                \::/    /        \::/____/                \::/    /                        \::/    /        \::/    /                \::/    /                \:|   |          
         ~~                       \/____/          ~~                       \/____/                          \/____/          \/____/                  \/____/                  \|___|          
                                                                                                                                                                                                
`
	fmt.Println("Starting BlueLink Backend Application...")
	fmt.Println(logo)

	// Load environment variables from .env file
	config := config.LoadConfig()

	// Initialize Sui client
	suiClient := sui.NewClient(config.SuiRPCURL)

	var r *gin.Engine
	if config.Environment == "production" {
		gin.SetMode(gin.ReleaseMode)
		r = gin.New()
		r.Use(gin.Recovery())
	} else {
		r = gin.Default()
	}

	// Setup routes
	r = setupRoutes(r, suiClient)

	// Start server
	port := config.Port
	if port == "" {
		port = "8080"
	}
	fmt.Printf("Server running on port %s\n", port)
	if err := r.Run(":" + port); err != nil {
		fmt.Printf("Failed to run server: %v\n", err)
	}

}
